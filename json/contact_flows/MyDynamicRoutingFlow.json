{
  "Version": "2019-10-30",
  "StartAction": "bfa4f090-02db-466b-ab61-85b07650ea50",
  "Metadata": {
    "entryPointPosition": {
      "x": 40,
      "y": 40
    },
    "ActionMetadata": {
      "bfa4f090-02db-466b-ab61-85b07650ea50": {
        "position": {
          "x": 161.6,
          "y": 347.2
        }
      },
      "4c074ebb-3bcb-4e72-aefb-b4c8f4eba897": {
        "position": {
          "x": 161.6,
          "y": 607.2
        }
      },
      "886492cf-b777-4944-a709-d55a506ae117": {
        "position": {
          "x": 161.6,
          "y": 87.2
        }
      },
      "28121137-6839-4ebd-95d0-dcf6d1b3c864": {
        "position": {
          "x": 441.6,
          "y": 87.2
        },
        "conditionMetadata": [
          {
            "id": "de180e09-c916-4070-b0fc-2f15a2524d96",
            "value": "1"
          },
          {
            "id": "1109e401-145b-43d3-b59f-9c1ea225218f",
            "value": "2"
          },
          {
            "id": "e32fedac-6e64-45c5-a77e-6fcc08db369d",
            "value": "3"
          }
        ]
      },
      "92ca418b-72d0-40f8-a1fb-011908f7e27b": {
        "position": {
          "x": 441.6,
          "y": 1387.2
        }
      },
      "eb25f729-8da5-4227-ba49-82da1a70a174": {
        "position": {
          "x": 721.6,
          "y": 87.2
        },
        "dynamicParams": []
      },
      "f773b2e9-2794-4616-82b6-da417b5316bc": {
        "position": {
          "x": 721.6,
          "y": 347.2
        },
        "dynamicParams": []
      },
      "4082ed9b-8c53-4435-9830-d28021a5f3f0": {
        "position": {
          "x": 721.6,
          "y": 607.2
        },
        "dynamicParams": []
      },
      "b3685f38-d907-4111-922d-52dfc9758b27": {
        "position": {
          "x": 721.6,
          "y": 867.2
        },
        "dynamicParams": []
      },
      "Dynamic Routing Function": {
        "position": {
          "x": 1088,
          "y": 47.2
        },
        "isFriendlyName": true,
        "parameters": {
          "LambdaInvocationAttributes": {
            "CallReason": {
              "useDynamic": true
            }
          }
        },
        "dynamicMetadata": {
          "CallReason": true
        }
      },
      "Error Queue": {
        "position": {
          "x": 1156.8,
          "y": 310.4
        },
        "isFriendlyName": true,
        "parameters": {
          "QueueId": {
            "displayName": "My Basic Queue"
          }
        },
        "queue": {
          "text": "My Basic Queue"
        }
      },
      "c60bdbb1-5faa-4d8e-b420-af4fb6f48940": {
        "position": {
          "x": 441.6,
          "y": 1127.2
        }
      },
      "8927658a-2677-4121-845a-6980ca96fec0": {
        "position": {
          "x": 1610.4,
          "y": 342.4
        }
      },
      "6ad5ee83-9f41-4590-ae31-364c5a1f00fc": {
        "position": {
          "x": 1364.8,
          "y": 48
        },
        "parameters": {
          "QueueId": {
            "useDynamic": true
          }
        },
        "useDynamic": true
      },
      "a526f7b5-c48d-486b-aa6f-7b2829b47ea1": {
        "position": {
          "x": 1652.8,
          "y": 81.6
        }
      }
    },
    "Annotations": [],
    "name": "My Dynamic Routing Flow",
    "description": "My Dynamic Routing Flow",
    "type": "contactFlow",
    "status": "published",
    "hash": {}
  },
  "Actions": [
    {
      "Parameters": {
        "FlowLoggingBehavior": "Enabled"
      },
      "Identifier": "bfa4f090-02db-466b-ab61-85b07650ea50",
      "Type": "UpdateFlowLoggingBehavior",
      "Transitions": {
        "NextAction": "4c074ebb-3bcb-4e72-aefb-b4c8f4eba897"
      }
    },
    {
      "Parameters": {
        "RecordingBehavior": {
          "RecordedParticipants": [
            "Agent",
            "Customer"
          ],
          "IVRRecordingBehavior": "Enabled"
        }
      },
      "Identifier": "4c074ebb-3bcb-4e72-aefb-b4c8f4eba897",
      "Type": "UpdateContactRecordingBehavior",
      "Transitions": {
        "NextAction": "886492cf-b777-4944-a709-d55a506ae117"
      }
    },
    {
      "Parameters": {
        "Text": "Welcome to the Amazon Connect Contact Center"
      },
      "Identifier": "886492cf-b777-4944-a709-d55a506ae117",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "28121137-6839-4ebd-95d0-dcf6d1b3c864",
        "Errors": [
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "StoreInput": "False",
        "InputTimeLimitSeconds": "5",
        "Text": "If you are calling about your recent purchase, please press 1. If you would like to repeat the previous order, please press 2. To place a new order, please press 3."
      },
      "Identifier": "28121137-6839-4ebd-95d0-dcf6d1b3c864",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
        "Conditions": [
          {
            "NextAction": "eb25f729-8da5-4227-ba49-82da1a70a174",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "1"
              ]
            }
          },
          {
            "NextAction": "f773b2e9-2794-4616-82b6-da417b5316bc",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "2"
              ]
            }
          },
          {
            "NextAction": "4082ed9b-8c53-4435-9830-d28021a5f3f0",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "3"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "b3685f38-d907-4111-922d-52dfc9758b27",
            "ErrorType": "InputTimeLimitExceeded"
          },
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "NoMatchingCondition"
          },
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {},
      "Identifier": "92ca418b-72d0-40f8-a1fb-011908f7e27b",
      "Type": "DisconnectParticipant",
      "Transitions": {}
    },
    {
      "Parameters": {
        "Attributes": {
          "CallReason": "RecentPurchase"
        }
      },
      "Identifier": "eb25f729-8da5-4227-ba49-82da1a70a174",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Dynamic Routing Function",
        "Errors": [
          {
            "NextAction": "Error Queue",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Attributes": {
          "CallReason": "RepeatOrder"
        }
      },
      "Identifier": "f773b2e9-2794-4616-82b6-da417b5316bc",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Dynamic Routing Function",
        "Errors": [
          {
            "NextAction": "Error Queue",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Attributes": {
          "CallReason": "NewOrder"
        }
      },
      "Identifier": "4082ed9b-8c53-4435-9830-d28021a5f3f0",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Dynamic Routing Function",
        "Errors": [
          {
            "NextAction": "Error Queue",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Attributes": {
          "CallReason": "NoSelection"
        }
      },
      "Identifier": "b3685f38-d907-4111-922d-52dfc9758b27",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Dynamic Routing Function",
        "Errors": [
          {
            "NextAction": "Error Queue",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "LambdaFunctionARN": "arn:aws:lambda:us-west-2:044336301301:function:connect-dynamic-routing-dynamic-router",
        "InvocationTimeLimitSeconds": "3",
        "InvocationType": "SYNCHRONOUS",
        "LambdaInvocationAttributes": {
          "CallReason": "$.Attributes.CallReason"
        },
        "ResponseValidation": {
          "ResponseType": "STRING_MAP"
        }
      },
      "Identifier": "Dynamic Routing Function",
      "Type": "InvokeLambdaFunction",
      "Transitions": {
        "NextAction": "6ad5ee83-9f41-4590-ae31-364c5a1f00fc",
        "Errors": [
          {
            "NextAction": "Error Queue",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "QueueId": "arn:aws:connect:us-west-2:044336301301:instance/9f8b8d92-18c0-44eb-9aa4-f070125770ea/queue/c4870cde-ee00-4d5a-a8fd-96a21f602229"
      },
      "Identifier": "Error Queue",
      "Type": "UpdateContactTargetQueue",
      "Transitions": {
        "NextAction": "8927658a-2677-4121-845a-6980ca96fec0",
        "Errors": [
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Text": "We are experiencing technical difficulties, please try again later."
      },
      "Identifier": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "92ca418b-72d0-40f8-a1fb-011908f7e27b",
        "Errors": [
          {
            "NextAction": "92ca418b-72d0-40f8-a1fb-011908f7e27b",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {},
      "Identifier": "8927658a-2677-4121-845a-6980ca96fec0",
      "Type": "TransferContactToQueue",
      "Transitions": {
        "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
        "Errors": [
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "QueueAtCapacity"
          },
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "QueueId": "$.External.queueArn"
      },
      "Identifier": "6ad5ee83-9f41-4590-ae31-364c5a1f00fc",
      "Type": "UpdateContactTargetQueue",
      "Transitions": {
        "NextAction": "a526f7b5-c48d-486b-aa6f-7b2829b47ea1",
        "Errors": [
          {
            "NextAction": "Error Queue",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Text": "You are being transferred to $.External.queueName"
      },
      "Identifier": "a526f7b5-c48d-486b-aa6f-7b2829b47ea1",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "8927658a-2677-4121-845a-6980ca96fec0",
        "Errors": [
          {
            "NextAction": "c60bdbb1-5faa-4d8e-b420-af4fb6f48940",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    }
  ]
}